(function(h){h.fn.umgclassic=function(d){d=h.extend({backgroundColor:"",slideshowBackground:"",titleColor:"0259C4",newPeriod:7,autoPlay:!1,pauseTime:5,thumbWidth:40,thumbHeight:40,videoWidth:550,videoHeight:400,audioWidth:400,audioHeight:150,scaleMode:"fit",animationSpeed:"slow",showDesc:"topright",quickNav:!0,allowRating:!0,showSocial:!0,hideOverlays:!0,autoPlayVideo:!0,showVideoControls:!0,linkInNewWindow:!1,galleryroot:"Gallery Root",xofy:"[x] of [y]",medias:" medias",childalbums:" child albums",
yourrate:"Rate it:",tagphoto:"Add / Delete",tagging:"Done",tagsassigned:"[x] tags assigned",sharethis:"Share this item by",currentalbum:"You are watching:",closealbum:"See all albums",readmore:"more",download:"Download",purchase:"Purchase",tagdefault:"",logoWidth:120,logoHeight:120,price:0,editable:!0,albumoffset:20,modulePath:"http://localhost/dnn450/desktopmodules/ultramediagallery/"},d);if(window.location.hash){var x,y,z=window.location.hash.substring(1);0<z.indexOf("/")?(x=parseInt(z.split("/")[0]),
y=parseInt(z.split("/")[1])):x=parseInt(z);if(x&&(d.defaultAlbum=x,y))d.defaultPhoto=y,d.autoPlay=!1}return this.each(function(){function x(){for(var a=c.find(".social .rate"),b=0;5>b;b++)a.append("<span class='star' data-score='"+b+"'></span>");a.children().hover(function(){a.children(":lt("+(1*h(this).attr("data-score")+1)+")").addClass("hover")},function(){a.children().removeClass("hover")});a.children().click(function(){var a=1*h(this).attr("data-score")+1,b=h(".mediathumb:eq("+m+")").attr("data-umgid");
dnn.xmlhttp.doCallBack(d.clientapi,"rate"+b+"@"+a,z,this,null,null,null,null,0)})}function z(a){if(0<a.indexOf("|")){var a=a.split("|"),b=1*a[1],d=1*a[2],a=q.find(".photo[data-umgid*="+1*a[0]+"]");a.attr("data-score",b);a.attr("data-ratings",d);da(a)}else a&&alert(a)}function y(a){var b=parseInt(a[0].style.left)+"",d=parseInt(a[0].style.top)+"";if(a.hasClass("newtag")){var e=a.children(".text").position().top+parseInt(a.css("margin-top")),e=e/a.parent().height(),d=1*d+Math.round(100*e);100<d&&(d=
100);d+=""}4>b.length&&(b="0000".substring(0,4-b.length)+b);4>d.length&&(d="0000".substring(0,4-d.length)+d);return b+"|"+d}function J(a){A.children(".album").remove();for(var b=a.children(".album"),k=0;k<b.length;k++){var e=h(b[k]),g="";if(0<e.children(".album").length){var g=e.children(".album").length+d.childalbums,f="",r;r=9>e.children(".album").length?2:3;for(var B=0;B<e.children(".album").length&&!(B>r*r);B++)var ea=(d.logoWidth-2)/r,f=f+("<div class='subalbumlogo' style='width:"+ea+"px;height:"+
(d.logoHeight-2)/r+"px;'><img src='"+h(e.children(".album")[B]).attr("data-logo")+"' style='width:"+(ea-8)+"px;' /></div>")}else g=e.children().length+d.medias,f="<img alt='Open this album' src='"+e.attr("data-logo")+"' />";r=!1;(B=e.attr("data-daysago"))&&B<d.newPeriod&&(r=!0);e=h("<table class='album' data-path='"+k+"' data-umgid='"+e.attr("data-umgid")+"'><tr><td class='tl'></td><td class='t'></td><td class='tr'></td></tr><tr><td class='l'></td><td><div class='main' style='width:"+d.logoWidth+
"px;height:"+d.logoHeight+"px;'>"+(r?"<div class='new'></div>":"")+f+"<div class='float'>"+g+"</div></div></td><td class='r'></td></tr><tr><td class='bl'></td><td class='b'></td><td class='br'></td></tr><tr><td colspan='3' class='title' style='width:"+d.logoWidth+"px;color:#"+d.titleColor+";'>"+e.attr("data-title")+"</td></tr><tr><td colspan='3' class='contents'>"+g+"</td></tr></table>");A.append(e);0>C&&(T=e.width(),U=e.height());0==k&&(C=Math.floor((c.height()-2*d.albumoffset)/(U+20)),N=Math.floor(c.width()/
(T+40)),V=c.width()/N,O=(c.height()-2*d.albumoffset)/C);g=Math.floor(k/N);f=2*d.albumoffset*Math.floor(g/C)+d.albumoffset+g*O+(O-U)/2;e.css("left",k%N*V+(V-T)/2);e.css("top",f);P=g+1}A.css("top",0);A.children(".album").click(function(){Q(this)});P>C?(fa.show(),ga(1)):fa.hide();if(a.hasClass("datahtml"))K.hide();else{K.show();K.children().remove();b="<span class='separator'></span><div class='a'><span class='left'></span><span class='center'>"+a.attr("data-title")+"</span><span class='right'></span></div>";
for(a=a.parent();!a.hasClass("datahtml");)b="<span class='separator'></span><a href='javascript:void(0);' data-umgid='"+a.attr("data-umgid")+"' ><span class='left'></span><span class='center'>"+a.attr("data-title")+"</span><span class='right'></span></a>"+b,a=a.parent();b="<a href='javascript:void(0);' data-umgid='0' ><span class='left'></span><span class='center'>"+d.galleryroot+"</span><span class='right'></span></a>"+b;K.html(b);K.children("a").click(function(){Q(this)})}}function ha(a){a=Math.floor(-1*
A.position().top/c.height())+a;if(!(0>a)&&!(a*C>=P)){var b=-1*a*c.height();A.css("top",b);ga(a+1)}}function ga(a){var b=Math.ceil(P*O/c.height()),k=d.xofy,k=k.replace("[x]",a),k=k.replace("[y]",b);ua.html(k);1<a?W.removeClass("disabled"):W.addClass("disabled");a<b?X.removeClass("disabled"):X.addClass("disabled")}function Q(a){a=1*h(a).attr("data-umgid");"0"==a?J(q):(a=q.find(".album[data-umgid*='"+a+"']"),0<a.children(".album").length?J(a):o?o&&o[0]==a[0]?D.animate({top:c.height()},"fast","linear",
function(){f.show()}):(l.children(".medialarge").remove(),o=a,D.animate({top:c.height()},"fast","linear",ia)):(o=a,D.animate({top:c.height()},"fast","linear",ia)))}function ia(){f.show();j.children().remove();for(var a=o.children(".photo"),b=-1,c=0;c<a.length;c++){var e=h(a[c]),e="<div class='mediathumb' data-index='"+c+"' data-umgid='"+e.attr("data-umgid")+"'><img alt='logo' title='"+e.attr("data-title")+"' src='"+e.attr("data-thumb")+"' style='width:"+d.thumbWidth+"px;height:"+d.thumbHeight+"px;' /></div>",
e=h(e);j.append(e);0==c&&(b=e.outerWidth(),parseInt(e.css("margin-left"))&&(b+=parseInt(e.css("margin-left"))),parseInt(e.css("margin-right"))&&(b+=parseInt(e.css("margin-right"))))}c=Math.floor((h(window).width()-parseInt(E.css("margin-left"))-parseInt(E.css("margin-right")))/b);if(a.length<c){a=c-a.length;for(c=0;c<a;c++)j.append("<div class='placeholder'><div style='width:"+d.thumbWidth+"px;height:"+d.thumbHeight+"px;'></div></div>")}a=0;j.css("padding-left")&&(a+=parseInt(j.css("padding-left")));
j.css("padding-right")&&(a+=parseInt(j.css("padding-right")));b=b*j.children().length+a;j.css("width",b);t.attr("data-inited")||(b=j.outerHeight(),50>b&&(b=50),t.css("height",b),t.attr("data-inited",1));h(".mediathumb").hover(function(){var a=h(this);a.addClass("current");p?p.show():(p=h("<div class='bigthumb' ><div class='bigthumbinner' ><img alt='thumbnail' src='' /></div></div>"),f.append(p));p.find("img").attr("src",a.children("img").attr("src"));var b=a.position().top+a.parent().position().top+
a.parent().parent().position().top+a.parent().parent().parent().position().top,d=a.position().left+a.parent().position().left+parseInt(a.parent().parent().css("margin-left"))+a.parent().parent().parent().position().left;p.css("top",b-p.height()-5);p.css("left",d+a.outerWidth()/2-p.width()/2)},function(){h(this).removeClass("current");p.hide()});h(".mediathumb").click(function(){f.children(".newtag").remove();f.children(".atag").remove();l.children(".multimedia").remove();var a=void 0;if(0<=m){var b=
h(".mediathumb:eq("+m+")").attr("data-umgid"),a=l.children(".medialarge[data-umgid*='"+b+"']");if(0<a.children(".newtag").length||a.children(".deleted").length){if(!window.confirm("Some tags have not been saved, are you sure you wish to abandon them?"))return;a.children(".deleted").removeClass("deleted")}}u=0;L=!1;h(".mediathumb").removeClass("beingplayed");b=h(this);b.addClass("beingplayed");m=1*b.attr("data-index");var c=b.attr("data-umgid"),e=q.find(".photo[data-umgid*='"+c+"']");va();var g=l.children("[data-umgid*='"+
c+"']");if(0<g.length)s.hide(),v(g),Y(a,g);else{s.show();w=!0;var i=ja(e.attr("data-url"));if("i"==i){var k=new Image;k.onload=function(){s.hide();w=!1;g=h("<div data-umgid='"+c+"' class='medialarge' data-width='"+k.width+"' data-height='"+k.height+"'><img src='"+k.src+"' alt='' width='100%' height='100%' /></div>");v(g);l.append(g);Y(a,g);ka(g);la(g)};k.src=e.attr("data-url")}else{if("v"==i)i="",Z?(i="true",d.autoPlayVideo||(i+="false"),i="<video src='"+e.attr("data-url")+"' type='video/mp4' width='100%' height='100%' autoplay='"+
i+"' controls='controls' />"):(i="",ma||(ma=!0,i+="&notification=Double click to watch in full screen."),d.autoPlayVideo||(i+="&autoStart=False"),d.showVideoControls&&(i+="&showControlBar=True"),i="<object allowFullScreen='True' allowScriptAccess='always' allowNetworking='all' width='100%' height='100%'><param name='movie' value='"+d.modulePath+"SimpleVideo.swf' /><param name='allowFullScreen' value='true' /><param name='wmode' value='transparent' /><param name='flashvars' value='video="+e.attr("data-url")+
"&sender="+M+i+"' /><embed src='"+d.modulePath+"SimpleVideo.swf' type='application/x-shockwave-flash' allowFullScreen='True' allowScriptAccess='always' allowNetworking='all' width='100%' height='100%' wmode='transparent' flashvars='video="+e.attr("data-url")+"&sender="+M+i+"'></embed></object>"),i="<div data-umgid='"+c+"' class='medialarge multimedia' style='width:"+d.videoWidth+"px;height:"+d.videoHeight+"px;'>"+i+"</div>",g=h(i),l.append(g),v(l.children(".multimedia[data-umgid*="+c+"]")),s.hide(),
w=!1,L=!0;else if("a"==i)i="",Z?i="<audio src='"+e.attr("data-url")+"' type='audio/mp3' width='100%' height='100%' autoplay='true' controls='controls' />":(i="",d.showVideoControls&&(i+="&showControlBar=True"),i="<object allowFullScreen='True' allowScriptAccess='always' wmode='transparent' width='100%' height='100%'><param name='movie' value='"+d.modulePath+"SimpleAudio.swf' /><param name='allowFullScreen' value='true' /><param name='wmode' value='transparent' /><param name='flashvars' value='sender="+
M+"&audio="+e.attr("data-url")+i+"' /><embed src='"+d.modulePath+"SimpleAudio.swf' type='application/x-shockwave-flash' allowFullScreen='True' allowScriptAccess='always' wmode='transparent' width='100%' height='100%' flashvars='sender="+M+"&audio="+e.attr("data-url")+i+"'></embed></object>"),i="<div data-umgid='"+c+"' class='medialarge multimedia' style='width:"+d.audioWidth+"px;height:"+d.audioHeight+"px;'>"+i+"</div>",g=h(i),l.append(g),v(l.children(".multimedia[data-umgid*="+c+"]")),s.hide(),w=
!1,L=!0;else if("f"==i){i="";if(Z){alert("Flash content is not available on your device.");return}i="<object allowFullScreen='True' allowScriptAccess='always' width='100%' height='100%'><param name='movie' value='"+e.attr("data-url")+"' /><param name='allowFullScreen' value='true' /><param name='wmode' value='transparent' /><embed src='"+e.attr("data-url")+"' type='application/x-shockwave-flash' allowFullScreen='True' allowScriptAccess='always' wmode='transparent' width='100%' height='100%'></embed></object>";
i="<div data-umgid='"+c+"' class='medialarge multimedia' style='width:"+e.attr("data-width")+"px;height:"+e.attr("data-height")+"px;'>"+i+"</div>";g=h(i);l.append(g);v(l.children(".multimedia[data-umgid*="+c+"]"));s.hide();w=!1}else if(""==i&&0<e.children(".htmlcontent").length){g=h("<div data-umgid='"+c+"' class='medialarge multimedia embedcode' style=''>"+e.children(".htmlcontent").text()+"</div>");l.append(g);var i=g.children().width(),n=g.children().height();g.children().css("width","100%").css("height",
"100%");g.children().removeAttr("width").removeAttr("height");g.css("width",i).css("height",n);v(l.children(".multimedia[data-umgid*="+c+"]"));s.hide();w=!1}Y(a,g);ka(g);la(g)}}d.allowRating&&da(e);if(""!=d.showDesc&&"none"!=d.showDesc){var i=f.find(".mediadesc"),o=f.find(".mediadesc .title"),i=f.find(".mediadesc .desc"),n=f.find(".mediadesc .link"),p=f.find(".mediadesc .res");o.html(e.attr("data-title"));(o=e.attr("data-desc"))||(o="");i.html(o);e.attr("data-link")?(n.show(),n.attr("href",e.attr("data-link"))):
n.hide();e.attr("data-res")?(p.show(),p.html()==d.download&&p.attr("href",e.attr("data-res"))):p.hide()}if(0<F&&(e=e.next().attr("data-url"),"i"==ja(e)))$||($=new Image),$.src=e;0>b.position().left+b.parent().position().left?(b=-1*b.position().left,j.animate({left:b},"slow")):j.position().left+b.position().left+b.outerWidth()>E.width()&&(e=j.find(".mediathumb:last"),i=na(e),e=e.position().left+i,b=-1*b.position().left,b+e<E.width()&&(b=E.width()-e),j.animate({left:b},"slow"));"undefined"!=typeof UPG_onPhotoLoad&&
UPG_onPhotoLoad(c);wa++});f.find(".closealbum .albumtitle").html(o.attr("data-title"));0<f.find(".closealbum img").length&&f.find(".closealbum img").attr("src",o.attr("data-logo"));oa(3E3);var g;d.defaultPhoto&&(g=h(".mediathumb[data-umgid*="+d.defaultPhoto+"]"),1>g.length&&(g=void 0));g||(g=h(".mediathumb:first"));g.trigger("click");d.autoPlay&&pa()}function da(a){var b=c.find(".social .ratingscore"),d=c.find(".social .ratingstars");if(a.attr("data-score")){var e=1*a.attr("data-score");b.html(e);
for(var b="",g=0;g<e-1;g++)b+="<span class='solid'></span>";0<e-g&&(e-=g,0.75<=e?(b+="<span class='solid'></span>",g+=1):0.25<=e&&(b+="<span class='semisolid'></span>",g+=1));for(;5>g;g++)b+="<span class='hollow'></span>";b="<div class='stars'>"+b+"</div>";a.attr("data-ratings")&&(b+="<div>based on "+a.attr("data-ratings")+" ratings</div>");d.html(b)}else b.html(0),d.html("<div>Not rated")}function oa(a){var b=f.find(".closealbum");0<b.length&&(a?b.stop().css("left",0).delay(a).animate({left:-1*b.width()},
"slow"):b.stop().animate({left:0},"slow"))}function ka(a){var b=q.find("[data-umgid*='"+a.attr("data-umgid")+"']").children(".tag");if(0<b.length){for(var c=0;c<b.length;c++){var e=h(b[c]),g="";e.attr("data-x")&&(g="left:"+e.attr("data-x")+"%;top:"+e.attr("data-y")+"%");e=h("<div class='atag' style='"+g+"'><div class='tagbody'><div class='deletetag'></div><div class='text'>"+e.attr("data-tag")+"</div></div></div>");a.append(e);e.css("margin-left",e.width()/-2)}a.find(".deletetag").click(function(){h(this).parent().parent().addClass("deleted");
return!1})}if(d.editable&&d.clientapi)a=f.find(".tagform .currenttags"),0==a.length&&(xa(),a=f.find(".tagform .currenttags")),c=d.tagsassigned,c=c.replace("[x]",b.length),a.html(c)}function xa(){f.append("<div class='tagform'><div class='placeholder'><div class='icon'></div></div><div class='currenttags'></div><div class='tag'></div></div>");var a=f.find(".tagform");a.find(".placeholder");var b=f.find(".tag");b.html(d.tagphoto);a.hover(function(){a.stop().animate({left:0},"slow")},function(){G||a.stop().animate({left:-1*
a.width()},"slow")});b.click(function(){var a=h(".mediathumb:eq("+m+")").attr("data-umgid"),b=l.children("[data-umgid*='"+a+"']");if(b.hasClass("multimedia"))alert("Only images can be tagged.");else{var c=h(this);if(c.html()==d.tagging){G=!1;c.html(d.tagphoto);b.removeClass("tagging");b.unbind("click");for(var c="",f=0;f<b.find(".atag").length;f++){var j=h(b.find(".atag")[f]);j.hasClass("deleted")||(c&&(c+=","),c+=y(j)+qa(j.find(".text").text()))}for(f=0;f<b.find(".newtag").length;f++)c&&(c+=","),
j=h(b.find(".newtag")[f]),c+=y(j)+qa(j.find("input").val());b.children(".newtag").remove();dnn.xmlhttp.doCallBack(d.clientapi,"tag "+a+"@"+c,ya,this,null,null,null,null,0)}else G=!0,c.html(d.tagging),b.addClass("tagging"),b.click(function(a){if(G){var b=h(this);b.children();b.children(".empty").remove();var c=h("<div class='newtag empty'><div class='frame'></div><div class='text'><input type='text' value='"+d.tagdefault+"' /></div></div>");b.append(c);var e=a.pageX-b.offset().left,a=a.pageY-b.offset().top;
c.css("left",Math.floor(100*(e/b.width()))+"%");c.css("top",Math.floor(100*(a/b.height()))+"%");var g=c.find("input");setTimeout(function(){g.focus()},10);g.keypress(function(a){if(27==a.which||0==a.which)h(this).parent().parent().remove();else if(13==a.which)return h(this).trigger("blur"),!1});g.blur(function(){if(""!=this.value.replace(/^\s+|\s+$/g,"")&&this.value.replace(/^\s+|\s+$/g,"")!=d.tagdefault)return h(this).parent().parent().removeClass("empty"),!0;h(this).parent().parent().remove()})}})}})}
function qa(a){return a.replace(",","SPACE")}function ya(a){""!=a?alert(a):ra||(alert("All tags are saved, it may only be displayed after a page refresh."),ra=!0)}function na(a){var b=a.outerWidth();parseInt(a.css("margin-left"))&&(b+=parseInt(a.css("margin-left")));parseInt(a.css("margin-right"))&&(b+=parseInt(a.css("margin-right")));return b}function sa(){var a=E.width(),b=j.position().left,c=j.find(".mediathumb:last"),d=na(c),c=c.position().left+d,d=Math.floor(a/d)*d;j.stop();this==ta[0]?0>b?(b=
j.position().left+d,0<b&&(b=0),j.animate({left:b},"slow")):j.animate({left:100},"fast").animate({left:0},"slow"):b+c>a?(b=j.position().left-d,b+c<a&&(b=a-c),j.animate({left:b},"slow")):(a=j.position().left,j.animate({left:a-100},"fast").animate({left:a},"slow"))}function Y(a,b){a&&(a.removeClass("top").addClass("bottom"),a.fadeOut(d.animationSpeed));b.removeClass("bottom").addClass("top");b.fadeIn(d.animationSpeed)}function la(a){a.bind("touchstart",function(a){a=a.originalEvent;this.start={pageX:a.touches[0].pageX,
pageY:a.touches[0].pageY,time:(new Date).getTime()};this.isScrolling=void 0;this.deltaX=0;this.element.style.webkitTransitionDuration=0});a.bind("touchmove",function(a){a=a.originalEvent;if(!this.start)this.start={pageX:a.touches[0].pageX,pageY:a.touches[0].pageY,time:(new Date).getTime()};if(!(1<a.touches.length||a.scale&&1!==a.scale)){this.deltaX=a.touches[0].pageX-this.start.pageX;if("undefined"==typeof this.isScrolling)this.isScrolling=!!(this.isScrolling||Math.abs(this.deltaX)<Math.abs(a.touches[0].pageY-
this.start.pageY));if(!this.isScrolling)a.preventDefault(),this.style.marginLeft=this.deltaX+"px"}});a.bind("touchend",function(){var a=1E3>(new Date).getTime()-this.start.time&&50<Math.abs(this.deltaX);h(this).stop().animate({"margin-left":0},"slow");!this.isScrolling&&a&&R(m+(0>this.deltaX?1:-1));this.start=void 0})}function va(){var a=f.find(".pager2 .pageindex");if(a){var b=f.find(".pager2 .prevpage"),c=f.find(".pager2 .nextpage"),e=h(".mediathumb").length,g=d.xofy,g=g.replace("[x]",m+1),g=g.replace("[y]",
e);a.html(g);0==m?b.addClass("disabled"):b.removeClass("disabled");m==e-1?c.addClass("disabled"):c.removeClass("disabled")}}function v(a){var b=1*a.attr("data-width"),c=1*a.attr("data-height");if(b){var e=l.width(),g=l.height(),f=b/e,g=c/g;"no"==d.scaleMode?(f=Math.min(f,g),1>f&&(f=1)):"fit"==d.scaleMode?f=Math.max(f,g):(d.scaleMode="max",f=Math.min(f,g));b=Math.round(b/f);c=Math.round(c/f);a.css("width",b);a.css("height",c);a.css("left",(e-b)/2);c>t.position().top?a.css("top",0):a.css("top",(t.position().top-
c)/2)}else a.css("left",(l.width()-a.width())/2),a.height()>t.position().top?a.css("top",0):a.css("top",(t.position().top-a.height())/2)}function pa(){0<F?aa():(ba.addClass("pause"),F=window.setInterval(M+".onInterval()",1E3))}function aa(){0>F||(window.clearInterval(F),F=-1,u=0,ba.removeClass("pause"))}function R(a){if(0>a||a>=h(".mediathumb").length)return!1;h(".mediathumb:eq("+a+")").trigger("click");return!0}function ja(a){a="undefined"!=typeof a?a.substring(a.lastIndexOf(".")+1,a.length).toLowerCase():
!1;return"mp4"==a||"flv"==a?"v":"mp3"==a?"a":"swf"==a?"f":""!=a?"i":""}var c=h(this);c.children().hide();var q=c.children(".datahtml");c.append("<div class='loading'></div>");c.append("<div class='albumlist'><div class='albuminner'></div><div class='pager'><div class='prevpage'></div><div class='pageindex'></div><div class='nextpage'></div></div><div class='albumpath'></div></div>");var D=c.find(".albumlist"),A=c.find(".albuminner"),K=c.find(".albumpath"),s=c.find(".loading"),fa=c.find(".pager"),
X=c.find(".nextpage"),W=c.find(".prevpage"),ua=c.find(".pageindex");c.append("<div class='slideshow'><div class='medialist'></div><div class='controls'><div class='playpause'></div><div class='prevgroup'></div><div class='thumblist'><div class='thumblistinner'></div></div><div class='nextgroup'></div><div class='fullscreen'></div></div></div>");var f=c.find(".slideshow"),l=c.find(".medialist"),t=c.find(".controls"),ba=c.find(".playpause"),ta=c.find(".prevgroup"),E=c.find(".thumblist"),j=c.find(".thumblistinner"),
n=c.find(".nextgroup"),S=c.find(".fullscreen");X.click(function(){ha(1)});W.click(function(){ha(-1)});ba.click(function(){u=d.pauseTime-1;m==h(".mediathumb").length-1&&(l.find(".top").removeClass("top").fadeOut(1E3),m=-1);pa()});S.click(function(){S.hasClass("return")?(c.removeClass("fullstate"),c.css("width",c.attr("data-width")),c.css("height",c.attr("data-height")),c.css("margin-left","auto"),c.css("margin-top","auto"),S.removeClass("return")):(c.addClass("fullstate"),c.attr("data-width",c.width()),
c.attr("data-height",c.height()),c.css("width",h(window).width()),c.css("height",h(window).height()),0<c.offset().left&&c.css("margin-left",-1*c.offset().left+"px"),0<c.offset().top&&c.css("margin-top",-1*c.offset().top+"px"),S.addClass("return"),scroll(0,0));D.css("top",c.height());J(q.find(".album[data-umgid*='"+o.attr("data-umgid")+"']").parent());var a=h(".mediathumb:eq("+m+")").attr("data-umgid"),a=l.children("[data-umgid*='"+a+"']");v(a)});ta.click(sa);n.click(sa);d.allowRating?(f.append("<div class='social'><div class='ratingscore'></div><div class='ratingstars'></div><div class='yourrate'></div><div class='rate'></div><div class='addthis_default_style addthis_toolbox addthis_32x32_style'><a class='addthis_button_facebook'></a><a class='addthis_button_twitter'></a><a class='addthis_button_email'></a><a class='addthis_button_linkedin'></a><a class='addthis_button_google_plusone'></a></div></div>"),
f.find(".social .ratingscore"),f.find(".social .ratingstars"),f.find(".social .yourrate").html(d.yourrate),x()):d.showSocial&&f.append("<div class='social'><div class='ratingscore'><div class='addthis'></div></div><div class='yourrate'>"+d.sharethis+"</div><div class='addthis_default_style addthis_toolbox addthis_32x32_style'><a class='addthis_button_facebook'></a><a class='addthis_button_twitter'></a><a class='addthis_button_email'></a><a class='addthis_button_linkedin'></a><a class='addthis_button_google_plusone'></a></div></div>");
n=f.find(".addthis_button_email");0<n.length&&n.click(function(){aa()});var H=c.find(".social");0<H.length&&(H.hover(function(){H.stop().animate({left:0},"slow")},function(){H.stop().animate({left:-1*H.width()},"slow")}),H.find(".addthis_toolbox").hover(function(){var a=h(".mediathumb:eq("+m+")").attr("data-umgid"),a="#"+o.attr("data-umgid")+"/"+a,b=window.location.href;window.location.hash&&(b=b.replace(location.hash,""));addthis.ost=0;addthis.update("share","url",b+a);addthis.ready()},function(){}));
d.quickNav&&(f.append("<div class='pager pager2'><div class='prevpage'></div><div class='pageindex'></div><div class='nextpage'></div></div>"),n=f.find(".pager2 .prevpage"),f.find(".pager2 .pageindex"),f.find(".pager2 .nextpage").click(function(){R(m+1)}),n.click(function(){R(m-1)}));""!=d.showDesc&&"none"!=d.showDesc&&(f.append("<div class='mediadesc "+d.showDesc+"'><div><div class='close'></div><div class='title' style='color:#"+d.titleColor+";'></div><div class='desc'></div><div class='buttons'><a class='link' target='"+
(d.linkInNewWindow?"_blank":"")+"'>"+d.readmore+"</a><a class='res' target='"+(d.linkInNewWindow?"_blank":"")+"'>"+(0<d.price?d.purchase:d.download)+"</a></div></div></div>"),f.find(".mediadesc .close").click(function(){f.find(".mediadesc").hasClass("closed")?f.find(".mediadesc").removeClass("closed"):f.find(".mediadesc").addClass("closed")}),0<d.price&&f.find(".mediadesc .res").click(function(){if("undefined"!=typeof UPG_AddToCart){var a=h(".mediathumb:eq("+m+")"),b=1*a.attr("data-umgid");UPG_AddToCart(b,
a.children("img").attr("src"))}}));if(1<c.find(".album").length){f.append("<div class='closealbum'><div class='placeholder'><div class='icon'></div></div><div class='title'>"+d.currentalbum+"</div><img src='' alt='logo' /><div class='albumtitle' style='color:#"+d.titleColor+";'></div><div class='return'>"+d.closealbum+"</div></div>");var I=f.find(".closealbum");I.find(".placeholder");n=I.find(".return");I.hover(function(){I.stop().animate({left:0},"slow")},function(){G||I.stop().animate({left:-1*
I.width()},"slow")});n.click(function(){f.hide();D.animate({top:0},"fast","linear",null)})}var p,M='jQuery("#'+c.attr("ID")+'")[0]',o,ma=!1,F=-1,u=0,m=-1,wa=0,w=!1,L=!1,G=!1,$=void 0,ra=!1,n=!1,ca=navigator.userAgent;if(ca.match(/iPhone/i)||ca.match(/iPod/i)||ca.match(/iPad/i))n=!0;var Z=n,C=-1,N=-1,V=-1,O=-1,T=-1,U=-1,P=-1;this.onInterval=function(){w||(u+=1,!L&&!G&&!(0<c.find(".social").length&&0==c.find(".social").position().left)&&u>=d.pauseTime&&(u=0,m<h(".mediathumb").length-1?R(m+1):(aa(),
oa())))};this.videoEnd=function(){L=!1};""!=d.backgroundColor&&c.css("background-color","#"+d.backgroundColor);""!=d.slideshowBackground&&f.css("background-color","#"+d.slideshowBackground);d.hideOverlays?f.hover(function(){f.addClass("hover")},function(){f.removeClass("hover")}):f.addClass("hover");J(q);(function(){if(d.defaultAlbum){var a=q.find(".album[data-umgid*="+d.defaultAlbum+"]");if(0<a.length){Q(a);foundDefault=!0;a.parent().hasClass("album")&&J(a.parent());return}}1==q.find(".album").length&&
(D.hide(),Q(h(q.find(".album")[0])))})();s.hide()})}})(jQuery);
